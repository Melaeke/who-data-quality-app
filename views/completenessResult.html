<div ng-controller="CompletenessResultsController as compResultCtrl">
	<div ng-show="compResultCtrl.result === undefined" style="height: 400px;"></div>
	<div ng-show="compResultCtrl.result">
		<h3>Result</h3>
				<alert style="margin-top: 10px; margin-bottom: 10px;"ng-repeat="alert in compResultCtrl.result.alerts track by $index" type="{{alert.type}}" close="compResultCtrl.result.alerts.splice($index, 1)">{{alert.msg}}</alert>
				<div style="margin-top: 10px; font-size: 90%;" class="table-responsive">
					<table class="table table-bordered table-striped table-condensed table-hover">
						
				        <thead>
				            <tr>
				            	<th nowrap ng-class="{headerCellWide: header.name === 'Data'}" ng-click="compResultCtrl.changeSortOrder($index)" ng-repeat="header in compResultCtrl.result.headers" ng-if="!header.hidden"><span>{{header.name}}</span><span ng-if="header.meta && !header.hidden" class="glyphicon glyphicon-sort"></span></th>
				            	<th></th>
				            </tr>
				        </thead>
				        
				        <tfoot>
				            <td colspan="{{1+compResultCtrl.result.headers.length}}">
					            <div style="margin-left:20px; margin-top:27px" class="pull-left">
					            <span style="font-size: 100%;" class="label label-danger">{{compResultCtrl.result.metaData.outlierRows}}</span> rows with violations of <span style="font-size: 100%;" class="label label-primary">{{compResultCtrl.result.metaData.totalRows}}</span> rows analysed</div>
					            
					            
					            <pagination total-items="compResultCtrl.result.metaData.outlierRows" items-per-page="10" max-size="5" ng-model="compResultCtrl.result.currentPage" class="pagination-sm pull-right" boundary-links="true" rotate="true"></pagination>
				            </td>
				        </tfoot>
				        
				        <tbody>
				        	<tr valign="middle" ng-repeat="row in compResultCtrl.result.pages[compResultCtrl.result.currentPage-1]">
				                
				                <!-- IF: Outlier and threshold -->
				                <td ng-if="compResultCtrl.result.type != 'gap'" ng-repeat="value in row.data track by $index" ng-class="{danger: (value < row.metaData.lowLimit || value > row.metaData.highLimit) && value != '' && !compResultCtrl.result.headers[$index].meta, valueCell: compResultCtrl.result.headers[$index].type != 'java.lang.String'}">
									{{value}}
				                </td>
				                
				                <!-- IF: Gap -->
				                <td ng-if="compResultCtrl.result.type === 'gap'" ng-repeat="value in row.data track by $index" ng-class="{warning: (value === '' && !compResultCtrl.result.headers[$index].meta), valueCell: compResultCtrl.result.headers[$index].type != 'java.lang.String'}">{{value}}
				                </td>
				                
				                <td>
				                	<span class="dropdown" on-toggle="toggled(open)">
				                      <a href class="dropdown-toggle">
				                              <span class="glyphicon glyphicon-th-list" style="color: black" aria-hidden="true"></span>
				                            </a>
				                      <ul class="dropdown-menu">
				                        <li><a href ng-click="compResultCtrl.showDetails(row);">Visualise</a></li>
				                        <li><a href ng-click="compResultCtrl.floatUp(row.metaData);">Float up</a></li>
				                        <li><a href ng-click="compResultCtrl.drillDown(row.metaData);">Drill down</a></li>
				                        <li><a href ng-click="compResultCtrl.sendMessage(row.metaData);">Contact</a></li>
				                      </ul>
				                      </span>
				                </td>    
				            </tr>
				    	</tbody>
				    	
					</table>
				</div>
		<div style="min-height: 400px; margin-top: 20px; margin-bottom: 20px;" id="detailedResult"></div>
	</div>
</div>